/* This is a modified version of the SVAR sample script
   that invokes the MPI-enabled parallel bootstrapping.

   The script should also work on non MPI-setups and would
   work like the original sample script.

   If something fails with MPI, to get the standard bootstrap
   working again you can do one of the following:
   1) Uninstall MPI altogether from your machine
   2) In gretl's preferences remove the path pointing to MPI
   3) Choose bootstrap iterations up to 1000
   4) Specify Mod.forcempi=0 before the call to SVAR_boot
   (where 'Mod' is the name of your model bundle)
*/

set verbose off
include SVAR.gfn
open sw_ch14.gdt

series infl = 400*ldiff(PUNEW)
rename LHUR unemp

list X = unemp infl
list Z = const

Mod = SVAR_setup("C", X, Z, 3)
Mod.horizon = 36
SVAR_restrict(&Mod, "C", 1, 2)

set stopwatch
SVAR_estimate(&Mod)
printf "Time (Cmodel) = %g\n", $stopwatch

# -> We omit the FEVD calculation here, not bootstrap-related

set stopwatch
bfail = SVAR_boot(&Mod, 2999)	# need a value >1000 to trigger MPI
printf "Failed = %d, Time (bootstrap) = %g\n", bfail, $stopwatch

IRFsave("simpleC.pdf", &Mod, 0, 0)	# 0 means "all"
